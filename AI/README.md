# Compiling with CMake

To compile with CMake you first have to create a build directory, enter it, and use CMake to setup for a release build

    mkdir build_release
    cd build_release
    cmake .. -DCMAKE_BUILD_TYPE=RELEASE -G="Unix Makefiles"
    make

CMake will just use your default compiler with default settings. To see the actual compiler flags used, do

    make clean
    make VERBOSE=1

In the future you only ever have to run make, there is no need to rerun cmake.

# Compiling debug version

Do the same steps but with DEBUG build type. This leaves out the NDEBUG flag and it is much slower.

    mkdir build_debug
    cd build_debug
    cmake .. -DCMAKE_BUILD_TYPE=DEBUG -G="Unix Makefiles"
    make

# Compiling with custom flags

To use custom flags, you have to also add a toolchain file.

With gcc:

    mkdir build_release_gcc
    cd build_release_gcc
    cmake .. -DCMAKE_BUILD_TYPE=RELEASE -G="Unix Makefiles" -DCMAKE_TOOLCHAIN_FILE=../cmake/toolchain-gcc.cmake
    make

With clang:

    mkdir build_release_clang
    cd build_release_clang
    cmake .. -DCMAKE_BUILD_TYPE=RELEASE -G="Unix Makefiles" -DCMAKE_TOOLCHAIN_FILE=../cmake/toolchain-clang.cmake
    make

To run clang static analysis:

    mkdir build_release_clang_analyze
    cd build_release_clang_analyze
    cmake .. -DCMAKE_BUILD_TYPE=RELEASE -G="Unix Makefiles" -DCMAKE_TOOLCHAIN_FILE=../cmake/toolchain-clang-analyze.cmake
    make

# Compiling with Emscripten

We have a toolchain file for emscripten:

    mkdir build_release_wasm
    cd build_release_wasm
    cmake .. -DCMAKE_BUILD_TYPE=RELEASE -DCMAKE_TOOLCHAIN_FILE=../cmake/toolchain-emcc.cmake
    make

## Running WebAssembly

In order to run the output generated by emcc (`wallwars_ai.html`), you typically cannot just open
the file in your browser for security reasons. Instead you need to run a small web server. EMCC
comes with `emrun` which does exactly that. So simply type

    emrun wallwars_ai.html

to open the web assembly code in your browser.
